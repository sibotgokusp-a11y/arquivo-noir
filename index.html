<!DOCTYPE html>
<html lang="pt-BR" data-theme="noir">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>O Arquivo Noir | Sistema Integrado v4</title>

    <link
        href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
        rel="stylesheet" />

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configura√ß√£o para o Tailwind reconhecer as vari√°veis do nosso CSS
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        base: 'var(--bg-base)',
                        surface: 'var(--bg-surface)',
                        modal: 'var(--bg-modal)',
                        primary: 'var(--text-primary)',
                        secondary: 'var(--text-secondary)',
                        accent: 'var(--accent-color)',
                        'accent-hover': 'var(--accent-hover)',
                    },
                    fontFamily: {
                        title: ['"Crimson Text"', 'serif'],
                        ui: ['"Inter"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-base text-primary font-ui overflow-x-hidden transition-colors duration-300">

    <nav id="main-nav"
        class="fixed top-0 w-full z-50 flex justify-between items-center px-6 py-4 bg-base/95 backdrop-blur border-b border-white/5">
        <div class="font-title text-2xl font-bold cursor-pointer" onclick="switchView('catalog')">
            Noir<span class="text-accent">.</span>
        </div>
        <div class="flex gap-4 items-center">
            <button class="btn btn-primary flex items-center gap-2" onclick="openUploadModal()">
                <span class="material-symbols-outlined text-sm">create_new_folder</span> Novo Dossi√™
            </button>
            <button class="btn btn-secondary flex items-center justify-center p-2" onclick="toggleSettings()">
                <span class="material-symbols-outlined">settings</span>
            </button>
        </div>
    </nav>

    <main id="view-catalog" class="view-section active pt-0 min-h-screen">

        <div class="relative w-full h-[75vh] flex items-center mb-12 overflow-hidden bg-black">
            <div id="hero-img-container" class="absolute inset-0 transition-opacity duration-700 ease-in-out opacity-0">
                <img id="hero-bg" src="" class="w-full h-full object-cover object-[center_30%] opacity-40 transition-transform duration-[10000ms] ease-linear scale-100" alt="Hero Background">
                <div class="absolute inset-0 bg-gradient-to-r from-base via-base/80 to-transparent"></div>
                <div class="absolute inset-0 bg-gradient-to-t from-base via-base/20 to-transparent"></div>
            </div>

            <div id="hero-content"
                class="relative z-10 px-6 md:px-12 max-w-3xl h-full flex flex-col justify-center pt-24 pb-10 transition-opacity duration-700 ease-in-out opacity-0">
                <div class="self-start">
                    <span id="hero-tag"
                        class="inline-block px-3 py-1 mb-4 text-xs font-bold tracking-widest text-accent border border-accent rounded-full bg-accent/10 backdrop-blur-sm shadow-[0_0_10px_rgba(139,30,30,0.3)] uppercase">
                        CARREGANDO...
                    </span>
                </div>

                <h1 id="hero-title"
                    class="font-title text-5xl md:text-7xl font-bold mb-4 leading-tight text-white drop-shadow-2xl">
                    ...
                </h1>

                <p id="hero-desc" class="text-secondary text-lg mb-8 line-clamp-3 max-w-xl drop-shadow-md">
                    Iniciando os arquivos do dossi√™...
                </p>

                <div class="flex flex-wrap gap-4">
                    <button id="hero-btn-read"
                        class="btn btn-primary shadow-lg shadow-accent/30 text-lg px-8 transition-transform hover:scale-105 flex items-center justify-center gap-2 h-14">
                        <span class="material-symbols-outlined">menu_book</span> Ler Arquivo
                    </button>

                    <button id="hero-btn-details"
                        class="btn bg-white/10 hover:bg-white/20 text-white border border-white/20 backdrop-blur-md text-lg px-6 transition-colors flex items-center justify-center gap-2 h-14">
                        <span class="material-symbols-outlined">info</span> Detalhes
                    </button>
                </div>
            </div>
        </div>

        <div id="catalog-content" class="pb-12 md:px-6"></div>

    </main>

    <main id="view-reader" class="view-section bg-black h-screen w-full relative overflow-hidden">
        <div id="reader-toolbar"
            class="absolute top-0 left-0 w-full h-16 bg-black/60 backdrop-blur-md flex justify-between items-center px-6 z-50 border-b border-white/10 transition-transform duration-300">
            <div class="flex items-center gap-4">
                <button class="toolbar-btn flex items-center gap-2" onclick="closeReader()" title="Voltar">
                    <span class="material-symbols-outlined">arrow_back</span> Sair
                </button>
                <span id="reader-title"
                    class="text-white font-semibold ml-2 truncate max-w-[200px] md:max-w-md">T√≠tulo</span>
            </div>

            <div class="flex items-center gap-3">
                <select id="page-selector"
                    class="bg-white/10 text-white border border-white/20 px-2 py-1 rounded font-ui outline-none cursor-pointer"
                    onchange="goToPage(parseInt(this.value))"></select>
                <span class="text-gray-400 text-sm">/ <span id="total-pages-label">0</span></span>

                <div class="w-px h-5 bg-white/20 mx-2"></div>

                <button class="toolbar-btn active" id="btn-fit-contain" onclick="setFitMode('contain')"
                    title="Ajustar √† Tela">
                    <span class="material-symbols-outlined">fit_screen</span>
                </button>
                <button class="toolbar-btn" id="btn-fit-width" onclick="setFitMode('width')" title="Ajustar √† Largura">
                    <span class="material-symbols-outlined">width_normal</span>
                </button>
                <button class="toolbar-btn" id="btn-fit-height" onclick="setFitMode('height')" title="Ajustar √† Altura">
                    <span class="material-symbols-outlined">height</span>
                </button>

                <div class="w-px h-5 bg-white/20 mx-2"></div>

                <button class="toolbar-btn" id="btn-spread" onclick="toggleSpreadMode()" title="P√°gina Dupla">
                    <span class="material-symbols-outlined">menu_book</span>
                </button>
                <button class="toolbar-btn" id="btn-fullscreen" onclick="toggleFullscreen()" title="Tela Cheia">
                    <span class="material-symbols-outlined">fullscreen</span>
                </button>
            </div>
        </div>

        <div class="absolute top-16 bottom-0 left-0 w-1/3 z-40 cursor-pointer" onclick="nextPage()"
            title="Pr√≥xima (Esquerda)"></div>
        <div class="absolute top-16 bottom-0 left-1/3 right-1/3 z-40" onclick="toggleToolbar()"></div>
        <div class="absolute top-16 bottom-0 right-0 w-1/3 z-40 cursor-pointer" onclick="prevPage()"
            title="Anterior (Direita)"></div>

        <div id="reader-canvas"
            class="reader-canvas fit-contain w-full h-full flex justify-center items-center bg-black transition-opacity duration-300">
            <img id="reader-img-2" src="" class="reader-page hidden shadow-2xl">
            <img id="reader-img-1" src="" class="reader-page shadow-2xl">
        </div>
    </main>

    <div id="itemModal"
        class="modal-overlay fixed inset-0 bg-black/80 backdrop-blur-sm z-[1000] flex justify-center items-center opacity-0 pointer-events-none transition-opacity duration-300"
        onclick="closeModal(event, 'itemModal')">
        <div class="modal-content bg-modal w-11/12 max-w-4xl rounded-lg border border-white/10 flex relative overflow-hidden shadow-2xl transform scale-95 transition-transform duration-300"
            onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-secondary hover:text-white transition-colors z-10"
                onclick="closeModal(event, 'itemModal')">
                <span class="material-symbols-outlined text-3xl">close</span>
            </button>
            <div class="w-2/5 hidden md:block"><img id="modalImg" src="" class="w-full h-full object-cover"></div>
            <div class="w-full md:w-3/5 p-8 flex flex-col justify-center">
                <h2 id="modalTitle" class="font-title text-3xl mb-2 text-primary">T√≠tulo</h2>
                <div id="modalMeta" class="text-accent font-semibold mb-6">Status</div>
                <p id="modalDesc" class="text-secondary leading-relaxed mb-8 border-l-2 border-accent pl-4">Descri√ß√£o...
                </p>
                <button class="btn btn-primary w-full md:w-auto self-start" onclick="openReader()">Continuar
                    Leitura</button>
            </div>
        </div>
    </div>

    <div id="uploadModal"
        class="modal-overlay fixed inset-0 bg-black/80 backdrop-blur-sm z-[1000] flex justify-center items-center opacity-0 pointer-events-none transition-opacity duration-300"
        onclick="closeModal(event, 'uploadModal')">
        <div class="bg-modal w-11/12 max-w-md rounded-lg border border-white/10 relative p-8 shadow-2xl transform scale-95 transition-transform duration-300"
            onclick="event.stopPropagation()">
            <button class="absolute top-4 right-4 text-secondary hover:text-white transition-colors"
                onclick="closeModal(event, 'uploadModal')">
                <span class="material-symbols-outlined text-2xl">close</span>
            </button>
            <h2 class="font-title text-2xl mb-2">Adicionar Evid√™ncia</h2>
            <p class="text-secondary text-sm mb-6">Selecione uma pasta com imagens. Os arquivos residir√£o na sess√£o
                atual.</p>

            <div class="mb-4">
                <label class="block text-secondary text-sm mb-2">T√≠tulo do Dossi√™</label>
                <input type="text" id="up-title"
                    class="w-full p-3 bg-white/5 border border-secondary rounded text-primary outline-none focus:border-accent font-ui"
                    placeholder="Ex: O Mist√©rio da Rua 9">
            </div>

            <div class="mb-4">
                <label class="block text-secondary text-sm mb-2">Categoria / Prateleira</label>
                <input type="text" id="up-category" list="existing-categories"
                    class="w-full p-3 bg-white/5 border border-secondary rounded text-primary outline-none focus:border-accent font-ui"
                    placeholder="Ex: Investiga√ß√£o, Favoritos, Conclu√≠dos">
                <datalist id="existing-categories"></datalist>
            </div>

            <div class="mb-6 relative">
                <label class="block text-secondary text-sm mb-2">Pasta com as P√°ginas</label>
                <div class="relative overflow-hidden w-full">
                    <button class="btn btn-secondary w-full flex justify-center items-center gap-2">
                        <span class="material-symbols-outlined">folder_open</span> Escolher Pasta
                    </button>
                    <input type="file" id="up-files" webkitdirectory directory multiple accept="image/*"
                        class="absolute inset-0 opacity-0 cursor-pointer">
                </div>
                <small id="up-count" class="text-accent block mt-2 font-medium"></small>
            </div>

            <button class="btn btn-primary w-full" onclick="processUpload()">Registrar no Arquivo</button>
        </div>
    </div>

    <div id="settingsPanel"
        class="fixed bottom-6 right-6 w-64 bg-modal border border-white/10 rounded-lg p-5 z-[999] shadow-2xl transform translate-y-4 opacity-0 pointer-events-none transition-all duration-300">
        <h3 class="font-title text-lg mb-4 border-b border-white/10 pb-2">Ajuste Visual</h3>
        <div class="flex flex-col gap-2">
            <button
                class="w-full p-2 bg-surface hover:border-accent border border-transparent rounded text-left transition-colors"
                onclick="setTheme('noir')">üï∂Ô∏è Cl√°ssico Noir</button>
            <button
                class="w-full p-2 bg-surface hover:border-accent border border-transparent rounded text-left transition-colors"
                onclick="setTheme('sepia')">üìú Arquivo S√©pia</button>
            <button
                class="w-full p-2 bg-surface hover:border-accent border border-transparent rounded text-left transition-colors"
                onclick="setTheme('midnight')">üåô Meia-noite</button>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script src="app.js"></script>
</body>

</html>